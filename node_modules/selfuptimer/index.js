const fetch = require("node-fetch")

async function SelfUptimer(url, Time) {
  require("http").createServer((_, res) => res.end(`
require("selfuptimer")("url", Time in ms((optional)defualt 30s)
\n\nThanks for using SelfUptimer`)).listen(3000)

  if (!url) throw new TypeError(`Please Provide the "Url"!`);
  if (!Time) console.error(`SelfUptime System : No specific time has been set, the time has been reset to 30s, which is a default`);
  const validUrl = require("valid-url");
  if (!validUrl.isUri(url)) {
    throw new Error("Please provide a vaild url!");
  }

  setInterval(function() {
    try {
      fetch(url);
    } catch (e) {
      throw new Error("Fetching Error, please check url again");
    }
  }, Time || 30000);
}
module.exports = SelfUptimer;